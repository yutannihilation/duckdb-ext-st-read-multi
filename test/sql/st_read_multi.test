# name: test/sql/st_read_multi.test
# description: test st_read_multi extension
# group: [spatial]

# Require statement will ensure the extension is loaded from now on
require st_read_multi

# TODO: I can't
statement ok
INSTALL spatial;

statement ok
LOAD spatial;

# Confirm the extension works
query III
SELECT ST_GeomFromWkb(geometry), val1, val2 FROM ST_Read_Multi('test/data/*.geojson');
----
POINT (1 2)	 1.0	a
POINT (10 20)	 2.0	b
POINT (100 200)	5.0	c
POINT (111 222)	6.0	d

# different_schema
statement error
SELECT ST_GeomFromWkb(geometry), val1, val2 FROM ST_Read_Multi('test/data/different_schema/*.geojson');
----
Binder Error: Schema mismatch in test/data/different_schema/points2.geojson: column 1 has name 'val3', expected 'val2'
